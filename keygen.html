
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NaijaShop | Subscription Key Gen</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=JetBrains+Mono:wght@500;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #022c22; color: #ecfdf5; }
        .mono { font-family: 'JetBrains Mono', monospace; }
        .glass { background: rgba(6, 78, 59, 0.4); backdrop-filter: blur(12px); border: 1px solid rgba(16, 185, 129, 0.2); }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-6">
    <div class="w-full max-w-md space-y-8">
        <div class="text-center space-y-2">
            <h1 class="text-3xl font-black uppercase tracking-tighter italic">NaijaKey v2.0</h1>
            <p class="text-emerald-500/60 text-xs font-bold uppercase tracking-[0.2em]">Subscription License Generator</p>
        </div>

        <div class="glass p-8 rounded-[40px] space-y-6">
            <div class="space-y-2">
                <label class="text-[10px] font-black text-emerald-500 uppercase tracking-widest ml-2">Request Code</label>
                <input type="text" id="requestCode" placeholder="NG-XX-XXX" class="w-full bg-black/20 border border-emerald-800/50 rounded-2xl px-5 py-4 mono text-emerald-400 focus:outline-none uppercase">
            </div>

            <div class="space-y-2">
                <label class="text-[10px] font-black text-emerald-500 uppercase tracking-widest ml-2">Subscription Months</label>
                <select id="months" class="w-full bg-black/20 border border-emerald-800/50 rounded-2xl px-5 py-4 mono text-emerald-400 focus:outline-none">
                    <option value="12">12 Months (₦10,000)</option>
                    <option value="24">24 Months (₦18,000)</option>
                    <option value="1">1 Month (Trial)</option>
                </select>
            </div>

            <div class="space-y-2">
                <label class="text-[10px] font-black text-emerald-500 uppercase tracking-widest ml-2">Secret Salt</label>
                <input type="password" id="salt" placeholder="VITE_APP_SALT" class="w-full bg-black/20 border border-emerald-800/50 rounded-2xl px-5 py-4 mono text-emerald-400 focus:outline-none">
            </div>

            <button onclick="generateKey()" class="w-full bg-emerald-500 text-emerald-950 font-black py-5 rounded-2xl shadow-xl uppercase tracking-widest text-xs flex items-center justify-center gap-2">
                Generate Yearly Key
            </button>
        </div>

        <div id="resultContainer" class="hidden">
            <div class="glass p-8 rounded-[40px] border-emerald-500/40 text-center space-y-4">
                <p class="text-[10px] font-black text-emerald-500/60 uppercase tracking-[0.3em]">Timed Activation Key</p>
                <div id="resultKey" class="text-2xl font-black mono tracking-widest text-white py-2 break-all cursor-pointer" onclick="copyKey()">XXXXX-XXXXX</div>
                <p id="expiryPreview" class="text-[9px] font-bold text-emerald-400 uppercase"></p>
            </div>
        </div>
    </div>

    <script>
        async function hashString(message) {
            const msgUint8 = new TextEncoder().encode(message);
            const hashBuffer = await crypto.subtle.digest('SHA-256', msgUint8);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
        }

        async function generateKey() {
            const code = document.getElementById('requestCode').value.trim().toUpperCase();
            const months = parseInt(document.getElementById('months').value);
            const salt = document.getElementById('salt').value.trim();

            if (!code || !salt) return alert("Fill all fields");

            // Calculate Expiry
            const expiryDate = new Date();
            expiryDate.setMonth(expiryDate.getMonth() + months);
            const expiryTs = expiryDate.getTime();
            const expiryHex = expiryTs.toString(16).toUpperCase();

            // Hash(Code + ExpiryHex + Salt)
            const signatureHash = await hashString(code + expiryHex + salt);
            const signature = signatureHash.substring(0, 10).toUpperCase();

            const finalKey = `${signature}-${expiryHex}`;

            document.getElementById('resultKey').innerText = finalKey;
            document.getElementById('expiryPreview').innerText = "Expires: " + expiryDate.toLocaleDateString();
            document.getElementById('resultContainer').classList.remove('hidden');
        }

        function copyKey() {
            const key = document.getElementById('resultKey').innerText;
            navigator.clipboard.writeText(key);
            alert("Copied!");
        }
    </script>
</body>
</html>
